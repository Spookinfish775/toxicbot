import random
import os
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, ContextTypes, MessageHandler, filters

TOXIC_PHRASES = [
    "Ты — ошибка синтаксиса в человеческом виде.",
    "Даже captcha умнее тебя.",
    "Ты как баг, который не фиксится.",
    "С тобой даже ИИ отказывается говорить.",
    "Ты мог бы быть полезен… в режиме 'не беспокоить'.",
    "Твоя логика — как null, вроде есть, но толку ноль.",
    "С тобой спорить — всё равно что дебажить NaN.",
    "Ты как while(true), только бессмысленнее.",
    "Если бы у глупости был интерфейс — ты бы его имплементировал.",
    "Ты — как зависимость без документации: никто не знает, зачем ты тут.",
    "Твоя харизма — как 404 Not Found.",
    "С тобой даже try/catch не справится.",
    "Ты — пример того, как не надо коммитить в реальность.",
    "Когда ты говоришь, даже console.log выдает undefined.",
    "Твоя самооценка — единственное, что у тебя в overload.",
    "Если бы интеллект был библиотекой — у тебя бы был missing import.",
    "Ты — как merge конфликт: от тебя все страдают.",
    "С тобой даже баг-репорты отказываются работать.",
    "Твоя речь — как плохо написанный regex: непонятна, бесполезна и опасна.",
    "Ты как AI, обученный только на спам-комментариях.",
    "У тебя такая глубина, как у пустого JSON-объекта.",
    "Ты — ошибка синтаксиса в человеческом виде.",
    "Даже captcha умнее тебя.",
    "Ты как баг, который не фиксится.",
    "С тобой даже ИИ отказывается говорить.",
    "Ты мог бы быть полезен… в режиме 'не беспокоить'.",
    "Твоя логика — как null, вроде есть, но толку ноль.",
    "С тобой спорить — всё равно что дебажить NaN.",
    "Ты как while(true), только бессмысленнее.",
    "Если бы у глупости был интерфейс — ты бы его имплементировал.",
    "Ты — как зависимость без документации: никто не знает, зачем ты тут.",
    "Твоя харизма — как 404 Not Found.",
    "С тобой даже try/catch не справится.",
    "Ты — пример того, как не надо коммитить в реальность.",
    "Когда ты говоришь, даже console.log выдает undefined.",
    "Твоя самооценка — единственное, что у тебя в overload.",
    "Если бы интеллект был библиотекой — у тебя бы был missing import.",
    "Ты — как merge конфликт: от тебя все страдают.",
    "С тобой даже баг-репорты отказываются работать.",
    "Твоя речь — как плохо написанный regex: непонятна, бесполезна и опасна.",
    "Ты как AI, обученный только на спам-комментариях.",
    "У тебя такая глубина, как у пустого JSON-объекта.",
    "Ты — как deprecated метод, который всё ещё используют, но никто не понимает зачем.",
    "С тобой даже debugger ломается.",
    "Ты как stack overflow без ответа.",
    "Ты — баг в продакшене, который никто не хочет видеть.",
    "Твой мозг — как mem leak: медленно, но верно умирает.",
    "Ты — как плохой commit message: никто не поймёт, что ты хотел сказать.",
    "Твои мысли — как глитч в коде, который никто не фиксит.",
    "Ты — функция без return, результата не будет.",
    "Ты вызываешь у всех ошибку 500 — внутреннюю ошибку сервера.",
    "Твои слова — как пустой callback: вызываются, но ничего не делают.",
    "Ты — баг, застрявший в вечном цикле.",
    "Твой интеллект — как база данных без индексов, работает медленно и неэффективно.",
    "Ты — баг, который происходит только на проде.",
    "Ты — как deprecated API: устарел, но всё ещё портит жизнь.",
    "Твоя логика вызывает segmentation fault в разговорах.",
    "Ты — как infinite loop, но без цели.",
    "Твой мозг — как uninitialized variable, никто не знает, что в нём.",
    "Ты — плохой патч, который создаёт ещё больше проблем.",
    "Твоя память — как volatile переменная: непредсказуемо меняется.",
    "Ты — баг, который вылезает только под давлением.",
    "Твой интеллект — как плохой шифр: легко взломать.",
    "Ты — баг, которого никто не фиксит, потому что боятся.",
    "Твои мысли — как SQL-инъекция: разрушают всё вокруг.",
    "Ты — функция с side effect, от которой все страдают.",
    "Твои слова — как null pointer exception в диалоге.",
    "Ты — баг, который появляется только в демо.",
    "Твой интеллект — как never-ending recursion.",
    "Ты — баг, который не воспроизводится на тестах.",
    "Ты — как баг в UI: раздражаешь и не даёшь работать.",
    "Твой мозг — как нерефакторенный код, полный копипасты.",
    "Ты — баг, которого никто не может локализовать.",
    "Ты — как забытый TODO в коде.",
    "Твои аргументы — как пустой массив: пусто и бессмысленно.",
    "Ты — как плохо настроенный CI/CD, который всё ломает.",
    "Твой интеллект — как битый файл, который нельзя открыть.",
    "Ты — баг, который вылезает только в пятницу вечером.",
    "Твои слова — как stack trace без полезной информации.",
    "Ты — баг, который появляется только в продакшн-режиме.",
    "Твой мозг — как старый ноутбук, который постоянно зависает.",
    "Ты — как отключённый internet, бесполезен без связи.",
    "Ты — баг, который прячется под дебагом.",
    "Твоя логика — как плохо написанный SQL-запрос, который тормозит всё.",
    "Ты — баг, который забыли зафиксить в релизе.",
    "Твой интеллект — как выключенный компилятор.",
    "Ты — баг, который создаёт больше вопросов, чем ответов.",
    "Твои слова — как пустой commit: ничего не меняют.",
    "Ты — как баг, который появляется только у менеджеров.",
    "Твой мозг — как старая версия библиотеки: давно устарел.",
    "Ты — баг, который невозможно воспроизвести на локальной машине.",
    "Ты — как неотключённый дебаггер, который мешает работе.",
    "Твой интеллект — как отсутствие документации.",
    "Ты — баг, который появляется только в понедельник утром.",
    "Твои слова — как deprecated функция: лучше не использовать.",
    "Ты — баг, который отказывается корректно работать.",
    "Твой мозг — как плохо структурированный код.",
    "Ты — баг, который никто не хочет исправлять.",
    "Ты — как конфигурация, сбитая с пути.",
    "Твои мысли — как плохо написанный паттерн.",
    "Ты — баг, который никто не репортит, но все боятся.",
    "Твой интеллект — как утечка памяти, которая медленно убивает.",
    "Ты — баг, который ломает все тесты.",
    "Твои слова — как отсутствующий файл в проекте.",
    "Ты — баг, который появляется только после деплоя.",
    "Твой мозг — как плохо оптимизированный алгоритм.",
    "Ты — баг, который вылезает только у клиента.",
    "Ты — как разрыв соединения с сервером.",
    "Твои аргументы — как ложный позитив в тестах.",
    "Ты — баг, который никто не понимает.",
    "Твой интеллект — как отсутствующая переменная.",
    "Ты — баг, который появляется на старых браузерах.",
    "Ты — как отсутствующий endpoint API.",
    "Твои слова — как плохо отформатированный JSON.",
    "Ты — баг, который рушит всю архитектуру.",
    "Твой мозг — как spaghetti-код.",
    "Ты — баг, который никто не фиксит, потому что ленятся.",
    "Ты — как отсутствующий README в проекте.",
    "Твои мысли — как баг в продакшн-логике.",
    "Ты — баг, который ломает user experience.",
    "Твой интеллект — как отсутствие unit-тестов.",
    "Ты — баг, который нельзя отследить.",
    "Ты — как фатальная ошибка в критическом модуле.",
    "Твои слова — как плохой patch, который ничего не улучшает.",
    "Ты — баг, который только усложняет жизнь.",
    "Твой мозг — как stale кэш: всегда устаревший."
]

async def toxic(update: Update, context: ContextTypes.DEFAULT_TYPE):
    phrase = random.choice(TOXIC_PHRASES)
    await update.message.reply_text(phrase)

async def handle_single_word_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text.strip()
    # Проверяем, что сообщение из одного слова и длина >= 4
    if len(text.split()) == 1 and len(text) >= 4:
        # Заменяем первые три буквы на 'хуе' и добавляем остаток
        new_word = "хуе" + text[3:]
        await update.message.reply_text(new_word)

TOKEN = os.getenv("BOT_TOKEN")

if __name__ == "__main__":
    app = ApplicationBuilder().token(TOKEN).build()
    app.add_handler(CommandHandler("toxic", toxic))
    # Добавляем обработчик сообщений
    app.add_handler(MessageHandler(filters.TEXT & (~filters.COMMAND), handle_single_word_message))
    app.run_polling()
